# Project Structure

## Architecture Pattern

Feature-based (Domain-Driven Design) - organize by business domain, not file type.

## Directory Layout

```
src/
├── app/                    # Global application configuration
│   ├── provider.tsx        # Root providers (QueryClient, Toaster, etc.)
│   ├── router.tsx          # TanStack Router root configuration
│   ├── query-client.ts     # TanStack Query client setup
│   ├── theme-config.ts     # Theme configuration
│   └── globals.css         # Global styles (Tailwind imports)
│
├── assets/                 # Static assets (images, SVGs)
│
├── components/             # Shared/reusable components
│   ├── ui/                 # shadcn/ui components (Button, Input, Form, etc.)
│   ├── common/             # Project-level shared components (PageContainer, etc.)
│   └── layout/             # Layout components (Header, Sidebar, etc.)
│
├── features/               # Business feature modules (CORE)
│   └── {feature-name}/     # e.g., dashboard, auth, users
│       ├── api/            # API layer (Zod schemas + query/mutation hooks)
│       │   ├── get-*.ts    # GET endpoints (useQuery hooks)
│       │   └── update-*.ts # POST/PUT/DELETE endpoints (useMutation hooks)
│       ├── components/     # Feature-specific components
│       └── routes/         # Feature routes (if not using file-based routing)
│
├── hooks/                  # Global custom hooks
│   ├── use-mobile.ts       # Responsive utilities
│   └── use-ui-store.ts     # UI state management (Zustand)
│
├── lib/                    # Infrastructure/utility layer
│   ├── api-client.ts       # Ky HTTP client with Zod validation
│   ├── env.ts              # Environment variable validation
│   └── utils.ts            # Utility functions (cn, tailwind-merge, etc.)
│
├── types/                  # Global shared types
│   └── api.d.ts            # API response wrappers, common types
│
├── routes/                 # File-based routes (TanStack Router)
│   └── *.tsx               # Route files (auto-generated route tree)
│
├── mocks/                  # MSW mock handlers
│   ├── browser.ts          # MSW browser setup
│   └── handlers.ts         # API mock handlers
│
├── test/                   # Test configuration
│   └── setup.ts            # Vitest global setup
│
├── main.tsx                # Application entry point
└── routeTree.gen.ts        # Auto-generated route tree (do not edit)
```

## Key Conventions

### Feature Module Structure

Each feature follows this pattern:

```
features/{feature-name}/
├── api/                    # API definitions (Schema + Hooks)
│   ├── get-resource.ts     # GET: Schema, Type, useQuery hook
│   └── update-resource.ts  # POST/PUT: Schema, Type, useMutation hook
├── components/             # Feature-specific UI components
│   ├── resource-form.tsx   # Forms with React Hook Form + Zod
│   └── resource-card.tsx   # Display components
└── routes/                 # Route components (optional)
```

### API Layer Pattern

Every API file follows this structure:

```typescript
// 1. Define Zod Schema (DTO)
export const ResourceSchema = z.object({...});

// 2. Infer TypeScript type
export type Resource = z.infer<typeof ResourceSchema>;

// 3. Define fetcher function with runtime validation
const getResource = async (id: string) => {
  const json = await api.get(`resource/${id}`).json();
  return ResourceSchema.parse(json); // Fail fast on schema mismatch
};

// 4. Export React Query hook
export function useResource(id: string) {
  return useQuery({
    queryKey: ['resource', id],
    queryFn: () => getResource(id),
  });
}
```

### File Naming

- **Files**: `kebab-case.ts` or `kebab-case.tsx`
- **Components**: `PascalCase` function names
- **Hooks**: `useCamelCase` function names
- **Types/Interfaces**: `PascalCase` (no `I` prefix)

### Import Aliases

- `@/*` maps to `src/*`
- Always use absolute imports for src files: `import { api } from '@/lib/api-client'`

## State Management Strategy

- **Server State**: TanStack Query (API data, caching, refetching)
- **URL State**: Nuqs (search filters, pagination, tabs)
- **Global UI State**: Zustand (sidebar open/closed, theme, modals)
- **Form State**: React Hook Form (never use useState for forms)
- **Local Component State**: useState (only for UI-only state)

## Routing

- **File-based routing** in `src/routes/`
- Route tree auto-generated by TanStack Router plugin
- Type-safe route parameters and search params
- Use `beforeLoad` for auth guards and data preloading

## Testing

- **Unit tests**: Co-located with source files using `.test.ts` suffix
- **Component tests**: Use Testing Library for user interaction testing
- **API mocking**: MSW intercepts network requests in development
- **Test setup**: Global test utilities in `src/test/setup.ts`
